<%- include('partials/header', { title: 'Documentation', pageCss: 'docs' }) %>

<div class="docs-layout">
    <div class="sidebar-overlay" id="docsOverlay"></div>

    <aside class="docs-sidebar" id="docsSidebar">
        <div class="docs-nav">
            <h3>Table of Contents</h3>
            <a href="#introduction" class="active">Introduction</a>
            <a href="#core-uploading">Core Uploading</a>
            <a href="#auth-security">Auth & Security</a>
            <a href="#file-management">File Management</a>
            <a href="#protection">Advanced Protection</a>
            <a href="#sharing-collab">Sharing & Collaboration</a>
            <a href="#viewer-preview">Viewer & Preview</a>
            <a href="#ui-ux">User Interface</a>
            <a href="#api-reference">API Reference</a>
            <a href="#compliance">Compliance</a>
        </div>
    </aside>

    <main class="docs-content">
        <button class="docs-toggle-btn" id="docsToggleBtn">
            <i class="fa-solid fa-bars"></i> Menu
        </button>

        <section id="introduction">
            <h1>Platform Documentation</h1>
            <p>Welcome to w-upload, a secure and advanced file hosting platform designed for performance, collaboration, and privacy. This documentation covers all available features and API endpoints.</p>
        </section>

        <section id="core-uploading">
            <h2><i class="fa-solid fa-cloud-arrow-up"></i> Core Uploading</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <strong>Drag & Drop</strong>
                    <p>Seamlessly drag files directly into the browser window.</p>
                </div>
                <div class="feature-item">
                    <strong>Paste to Upload</strong>
                    <p>Paste images from clipboard (Ctrl+V) instantly.</p>
                </div>
                <div class="feature-item">
                    <strong>Folder Upload</strong>
                    <p>Upload entire directory structures at once.</p>
                </div>
                <div class="feature-item">
                    <strong>Remote Upload</strong>
                    <p>Fetch files from external URLs directly to storage.</p>
                </div>
                <div class="feature-item">
                    <strong>Chunked Upload</strong>
                    <p>Reliable large file support (GBs) via chunking.</p>
                </div>
                <div class="feature-item">
                    <strong>Real-time Progress</strong>
                    <p>Visual progress bars for upload status tracking.</p>
                </div>
                <div class="feature-item">
                    <strong>Auto Watermark</strong>
                    <p>Apply text watermarks to images automatically.</p>
                </div>
                <div class="feature-item">
                    <strong>Deduplication</strong>
                    <p>MD5 hash checking prevents duplicate storage.</p>
                </div>
                <div class="feature-item">
                    <strong>MIME Detection</strong>
                    <p>Automatic file type verification and handling.</p>
                </div>
                <div class="feature-item">
                    <strong>Quota Check</strong>
                    <p>Pre-upload verification of available storage space.</p>
                </div>
            </div>
        </section>

        <section id="auth-security">
            <h2><i class="fa-solid fa-shield-halved"></i> Authentication & Security</h2>
            <ul class="doc-list">
                <li><strong>Bcrypt Hashing:</strong> Secure password storage with salt.</li>
                <li><strong>2FA (TOTP):</strong> Google Authenticator integration for login.</li>
                <li><strong>Login Rate Limit:</strong> Max 5 attempts per minute per IP.</li>
                <li><strong>Register Rate Limit:</strong> Max 1 account per hour per IP.</li>
                <li><strong>Account Lockout:</strong> Temporary ban after failed attempts.</li>
                <li><strong>Session Management:</strong> Track active devices, OS, and browsers.</li>
                <li><strong>Device Control:</strong> Revoke specific sessions or logout all.</li>
                <li><strong>Password Policy:</strong> 90-day expiry and strength validation.</li>
                <li><strong>API Key Management:</strong> Generate keys for script access.</li>
                <li><strong>Secure Headers:</strong> HttpOnly cookies and Bearer token support.</li>
                <li><strong>IP Logging:</strong> Detailed activity and login history logs.</li>
                <li><strong>Emergency Logout:</strong> Instantly terminate all active sessions.</li>
            </ul>
        </section>

        <section id="file-management">
            <h2><i class="fa-solid fa-folder-tree"></i> File Management</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <strong>Nested Folders</strong>
                    <p>Create deep directory structures.</p>
                </div>
                <div class="feature-item">
                    <strong>Breadcrumbs</strong>
                    <p>Easy navigation through folder hierarchy.</p>
                </div>
                <div class="feature-item">
                    <strong>Bulk Actions</strong>
                    <p>Move, Delete, or Star multiple files.</p>
                </div>
                <div class="feature-item">
                    <strong>Trash System</strong>
                    <p>Soft-delete with restore and empty options.</p>
                </div>
                <div class="feature-item">
                    <strong>Advanced Search</strong>
                    <p>Filter by name, tags, types, or content.</p>
                </div>
                <div class="feature-item">
                    <strong>Meta Editing</strong>
                    <p>Modify descriptions, tags, and filenames.</p>
                </div>
                <div class="feature-item">
                    <strong>Sorting</strong>
                    <p>Order by Date, Name, Size, or Type.</p>
                </div>
                <div class="feature-item">
                    <strong>View Modes</strong>
                    <p>Switch between Grid and List layouts.</p>
                </div>
            </div>
        </section>

        <section id="protection">
            <h2><i class="fa-solid fa-lock"></i> Advanced Protection</h2>
            <ul class="doc-list">
                <li><strong>Password Protection:</strong> Encrypt links with custom passwords.</li>
                <li><strong>Password Hint:</strong> Provide clues for protected files.</li>
                <li><strong>Expiration Timer:</strong> Auto-delete files after set time.</li>
                <li><strong>Download Limit:</strong> Auto-delete after X downloads.</li>
                <li><strong>Burn After Read:</strong> Self-destruct after first access.</li>
                <li><strong>Geo-Fencing:</strong> Restrict access by IP location.</li>
                <li><strong>Access Requests:</strong> Approval system for private files.</li>
                <li><strong>Hidden Files:</strong> Conceal files from the dashboard.</li>
            </ul>
        </section>

        <section id="sharing-collab">
            <h2><i class="fa-solid fa-share-nodes"></i> Sharing & Collaboration</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <strong>Teams</strong>
                    <p>Create organizations with shared quotas.</p>
                </div>
                <div class="feature-item">
                    <strong>Collaborators</strong>
                    <p>Invite users to edit specific files.</p>
                </div>
                <div class="feature-item">
                    <strong>File Requests</strong>
                    <p>Public links for receiving uploads.</p>
                </div>
                <div class="feature-item">
                    <strong>Public Profile</strong>
                    <p>Showcase assets at <code>/u/username</code>.</p>
                </div>
                <div class="feature-item">
                    <strong>Social Share</strong>
                    <p>Direct integration with WhatsApp/Twitter.</p>
                </div>
                <div class="feature-item">
                    <strong>Email Share</strong>
                    <p>Send secure links directly to email.</p>
                </div>
                <div class="feature-item">
                    <strong>Engagement</strong>
                    <p>Comments and Reactions (Like/Love).</p>
                </div>
                <div class="feature-item">
                    <strong>Referral System</strong>
                    <p>Earn bonus storage by inviting friends.</p>
                </div>
            </div>
        </section>

        <section id="viewer-preview">
            <h2><i class="fa-solid fa-eye"></i> Viewer & Preview</h2>
            <ul class="doc-list">
                <li><strong>Code Viewer:</strong> Syntax highlighting (JS, Py, HTML, etc.).</li>
                <li><strong>Media Player:</strong> Built-in Video and Audio streaming.</li>
                <li><strong>Image Preview:</strong> High-res previews for standard formats.</li>
                <li><strong>Statistics:</strong> Real-time download counters and history.</li>
                <li><strong>Smart Formatting:</strong> Auto-convert bytes to KB/MB/GB.</li>
                <li><strong>MIME Icons:</strong> Auto-detection of file type icons.</li>
                <li><strong>404 Handling:</strong> Custom error pages for missing files.</li>
            </ul>
        </section>

        <section id="ui-ux">
            <h2><i class="fa-solid fa-wand-magic-sparkles"></i> Interface (UI/UX)</h2>
            <ul class="doc-list">
                <li><strong>Responsive:</strong> Full mobile support with off-canvas sidebar.</li>
                <li><strong>Theme System:</strong> Automatic Dark/Light mode switching.</li>
                <li><strong>Toasts:</strong> Non-intrusive status notifications.</li>
                <li><strong>Context Menus:</strong> Right-click actions for efficiency.</li>
                <li><strong>Modals:</strong> Smooth dialogs for settings and inputs.</li>
                <li><strong>Loading States:</strong> Visual feedback for operations.</li>
                <li><strong>Visual Quota:</strong> Storage usage progress bar.</li>
                <li><strong>Tabbed UI:</strong> Organized settings and sharing options.</li>
                <li><strong>Animations:</strong> Smooth CSS transitions.</li>
            </ul>
        </section>

        <section id="api-reference">
            <h2><i class="fa-solid fa-code"></i> API Reference</h2>
            <p>Authentication via <code>Authorization: Bearer &lt;token&gt;</code> or <code>x-api-key: &lt;key&gt;</code>.</p>
            
            <div class="api-endpoint">
                <span class="method post">POST</span> 
                <span class="url">/api/upload</span>
                <p>Upload Base64 file. Params: <code>filename, base64, contentType</code></p>
            </div>
            
            <div class="api-endpoint">
                <span class="method post">POST</span> 
                <span class="url">/api/upload/remote</span>
                <p>Fetch from URL. Params: <code>url, parentId</code></p>
            </div>

            <div class="api-endpoint">
                <span class="method put">PUT</span> 
                <span class="url">/api/files/:id/protect</span>
                <p>Security settings. Params: <code>password, expires, burn, geo</code></p>
            </div>

            <div class="api-endpoint">
                <span class="method post">POST</span> 
                <span class="url">/api/files/:id/email-share</span>
                <p>Send via email. Params: <code>email</code></p>
            </div>
            
            <div class="api-endpoint">
                <span class="method post">POST</span> 
                <span class="url">/api/file-requests</span>
                <p>Create request link. Params: <code>label, folderId</code></p>
            </div>
        </section>

        <section id="compliance">
            <h2><i class="fa-solid fa-file-contract"></i> Compliance</h2>
            <ul class="doc-list">
                <li><strong>Report System:</strong> Abuse handling for Copyright/Malware.</li>
                <li><strong>Audit Logs:</strong> Full record of login attempts.</li>
                <li><strong>Sanitization:</strong> XSS/Injection prevention on inputs.</li>
                <li><strong>Privacy:</strong> Public profile toggle and visibility controls.</li>
            </ul>
        </section>
    </main>
</div>

<style>
    .docs-toggle-btn { margin-bottom: 2rem; }
    .sidebar-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5); z-index: 90; display: none;
    }
    .sidebar-overlay.active { display: block; }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('docsSidebar');
    const toggleBtn = document.getElementById('docsToggleBtn');
    const overlay = document.getElementById('docsOverlay');

    function toggleDocsSidebar() {
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
    }

    if(toggleBtn) toggleBtn.addEventListener('click', toggleDocsSidebar);
    if(overlay) overlay.addEventListener('click', toggleDocsSidebar);

    document.querySelectorAll('.docs-nav a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelectorAll('.docs-nav a').forEach(a => a.classList.remove('active'));
            this.classList.add('active');
            
            const target = document.querySelector(this.getAttribute('href'));
            if(target) {
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // Close mobile sidebar on click
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        });
    });

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute('id');
                document.querySelectorAll('.docs-nav a').forEach(a => a.classList.remove('active'));
                const activeLink = document.querySelector(`.docs-nav a[href="#${id}"]`);
                if(activeLink) activeLink.classList.add('active');
            }
        });
    }, { threshold: 0.1 });

    document.querySelectorAll('section').forEach((section) => {
        observer.observe(section);
    });
});
</script>

<%- include('partials/footer') %>